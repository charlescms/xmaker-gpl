<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage Express 2.0">
<title>TShakeTransition</title>
</head>

<body bgcolor="#FFFFFF">

<h3>TShakeTransition</h3>

<p><font size="2">This transition performs a 'shake' on your
screen. You can see it on the Demo project.</font></p>

<p><font face="Arial">Code</font></p>

<pre>unit teShake;

    interface

    uses Classes, Windows, SysUtils, Graphics, TransEff;

    type
      TShakeTransition = class(TTransitionEffect)
      protected
        procedure DoExecute(Data: TTETransitionData); override;
        function  NeedDstImage: Boolean; override;
      end;

    implementation

    uses
      teRender, teChrono;

    function TShakeTransition.NeedDstImage: Boolean;
    begin
      Result := False;
    end;

    procedure TShakeTransition.DoExecute(Data: TTETransitionData);
    var
      Chrono: TTEChrono;
      PosX,
      PosY: Integer;
    begin
      Chrono := TTEChrono.Create;
      try
        Randomize;
        Chrono.Start;
        while Chrono.Milliseconds &lt; Milliseconds do
        begin
          PosX := Random(7);
          PosY := Random(7);

          BitBlt(Data.Canvas.Handle, PosX-3, PosY-3, Data.Width, Data.Height,
            Data.SrcBmp.Canvas.Handle, 0, 0, cmSrcCopy);

          Sleep(35);
        end;
        BitBlt(Data.Canvas.Handle, 0, 0, Data.Width, Data.Height,
          Data.SrcBmp.Canvas.Handle, 0, 0, cmSrcCopy);
      finally
        Chrono.Free;
      end;
    end;

    end.</pre>
</body>
</html>
